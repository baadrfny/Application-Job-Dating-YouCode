{# views/back/dashboard/index.twig #}
<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Dashboard - Job Dating</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-light">

<nav class="navbar navbar-dark bg-dark mb-4">
    <div class="container">
        <span class="navbar-brand">YouCode Job Dating - Admin</span>
    </div>
</nav>

<div class="container">
    <div class="row text-center mb-5">
        <div class="col-md-3">
            <div class="card shadow-sm border-primary">
                <div class="card-body">
                    <h6 class="text-muted">Annonces Actives</h6>
                    <h2 class="text-primary">{{ stats.active_annonces }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow-sm border-secondary">
                <div class="card-body">
                    <h6 class="text-muted">Archives</h6>
                    <h2 class="text-secondary">{{ stats.archived_annonces }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow-sm border-success">
                <div class="card-body">
                    <h6 class="text-muted">Entreprises</h6>
                    <h2 class="text-success">{{ stats.total_entreprises }}</h2>
                </div>
            </div>
        </div>
        <div class="col-md-3">
            <div class="card shadow-sm border-info">
                <div class="card-body">
                    <h6 class="text-muted">Apprenants</h6>
                    <h2 class="text-info">{{ stats.total_apprenants }}</h2>
                </div>
            </div>
        </div>
    </div>

    <div class="card shadow">
        <div class="card-header bg-white d-flex justify-content-between align-items-center">
            <h5 class="mb-0">Dernières Annonces (Test Logique)</h5>
            <a href="/admin/announcements/create" class="btn btn-sm btn-primary">+ Ajouter</a>
        </div>
        <div class="card-body">
            <table class="table">
                <thead>
                    <tr>
                        <th>Titre</th>
                        <th>Entreprise ID</th>
                        <th>Date</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody>
                    {% for annonce in latestAnnonces %}
                    <tr>
                        <td>{{ annonce.titre }}</td>
                        <td><span class="badge bg-dark">{{ annonce.entreprise_id }}</span></td>
                        <td>{{ annonce.created_at|date("d/m/Y") }}</td>
                        <td>
                            {% if not annonce.deleted_at %}
                                <span class="text-success">Active</span>
                            {% else %}
                                <span class="text-danger">Archivée</span>
                            {% endif %}
                        </td>
                    </tr>
                    {% else %}
                    <tr><td colspan="4" class="text-center">Aucune donnée trouvée.</td></tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
    
    <div class="mt-4 p-3 bg-warning bg-opacity-10 border border-warning rounded">
        <strong>Test Info:</strong> 
        إذا قمت بحذف شركة من قاعدة البيانات، ستلاحظ اختفاء إعلاناتها من هنا تلقائياً بسبب <b>Cascade Delete</b>.
    </div>
</div>

</body>
</html>